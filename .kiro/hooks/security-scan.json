{
  "name": "Security Vulnerability Scan",
  "description": "Scan for security issues in authentication and API code",
  "version": "1.3",
  "created": "2025-11-18T10:00:00Z",
  "lastModified": "2025-11-20T15:30:00Z",
  "trigger": {
    "type": "onSave",
    "filePattern": "**/{auth,api,main,config,rate_limiter}.py"
  },
  "actions": [
    {
      "type": "agent",
      "prompt": "Analyze ${file} for security vulnerabilities:\n- SQL injection risks\n- Exposed secrets or API keys\n- Insecure authentication patterns\n- Missing input validation\n- CORS misconfigurations\n- Rate limiting bypass\n- JWT token handling\n\nProvide specific line numbers and remediation steps.",
      "context": ["${file}"],
      "model": "gpt-4",
      "temperature": 0.1
    }
  ],
  "enabled": true,
  "stats": {
    "totalExecutions": 8,
    "issuesFound": 7,
    "criticalIssues": 2,
    "warningIssues": 5,
    "lastExecution": "2025-11-20T15:30:00Z"
  },
  "findings": [
    {
      "date": "2025-11-19T10:25:00Z",
      "file": "core/auth.py",
      "severity": "critical",
      "issue": "JWT secret not validated before use",
      "status": "fixed"
    },
    {
      "date": "2025-11-20T11:30:00Z",
      "file": "main.py",
      "severity": "warning",
      "issue": "Missing input length validation",
      "status": "fixed"
    },
    {
      "date": "2025-11-20T11:30:00Z",
      "file": "main.py",
      "severity": "warning",
      "issue": "Rate limit middleware could be bypassed",
      "status": "documented"
    },
    {
      "date": "2025-11-19T10:25:00Z",
      "file": "core/auth.py",
      "severity": "warning",
      "issue": "Error messages too verbose",
      "status": "fixed"
    }
  ]
}
